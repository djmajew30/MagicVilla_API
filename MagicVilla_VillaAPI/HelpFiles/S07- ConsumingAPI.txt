https://github.com/bhrugen/MagicVilla_API/commits/master/?before=ded7b5475d6514cb2865de5293a001ebb3aeda45+70

58. CONSUMING API- Setup MVC Web Project after api in place
https://github.com/bhrugen/MagicVilla_API/commit/a222c407265b7b06a55783d6d0bf0d15696d8845#diff-05efd0252ddf692779afc49ff88d90ac7ea002dedc9af470ce100dba6733af9a

create new project in solution
right click solution, add, projects
mvc core web app model view controller
to view, set as start up project by right clicking on it

ERROR: INDEX NOT FOUND

Packages, using .net7 for this:

1st install nuget package
Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation

MagicVilla_Web\Program.cs

	// Add services to the container.
	//builder.Services.AddControllersWithViews()
	builder.Services.AddControllersWithViews().AddRazorRuntimeCompilation();

before changing port number
https://localhost:7284/
https://localhost:7245/swagger/index.html

Change port number in 
MagicVilla_VillaAPI/Properties/launchSettings.json
      "applicationUrl": "https://localhost:7001;http://localhost:5121",
MagicVilla_Web/Properties/launchSettings.json
      "applicationUrl": "https://localhost:7002;http://localhost:5158"

Right click on solution, set startup projects
common properties, startup project, multiple startup projects, action start


59. Web Project DTO's and API Models, constants in application
https://github.com/bhrugen/MagicVilla_API/commit/ddd9a7c2028b35f5302587b303da81b521b5fc14#diff-1d053aa46a443d4e062f3163e5bd2a348ab54cf09c3aa772cac07740aff85333
Copy models folder to web project
remove villa and villanumber
Change namespaces to MagicVilla_Web for apiresponse and dtos

constants in application
should be separated, but will show how when we keep them together
new project class library
MagicVilla_Utility/SD.cs

    public static class SD //static details
    {
        public enum ApiType
        {
            GET,
            POST,
            PUT,
            DELETE
        }
    }

create new class MagicVilla_Web/Models/APIRequest.cs

    public class APIRequest  //when we request from an endpoint
    {
        public ApiType ApiType { get; set; } = ApiType.GET;
        public string Url { get; set; }
        public object Data { get; set; }
    }

add project reference
right click web proj, add, project reference and select utility 


60. AutoMapper in web project
Install nuget packages
AutoMapper
AutoMapper.Extensions.Microsoft.DependencyInjection

Create MagicVilla_Web/MappingConfig.cs

    public class MappingConfig : Profile
    {
        public MappingConfig()
        {
            CreateMap<VillaDTO, VillaCreateDTO>().ReverseMap();
            CreateMap<VillaDTO, VillaUpdateDTO>().ReverseMap();

            CreateMap<VillaNumberDTO, VillaNumberCreateDTO>().ReverseMap();
            CreateMap<VillaNumberDTO, VillaNumberUpdateDTO>().ReverseMap();
        }
    }

add to MagicVilla_Web/Program.cs

    using MagicVilla_Web;
    ...
    // Add services to the container.
    builder.Services.AddControllersWithViews().AddRazorRuntimeCompilation();
    builder.Services.AddAutoMapper(typeof(MappingConfig));
    var app = builder.Build();


61. Add API URL in AppSettings.json
Do not hard code into controller or class file

API: https://localhost:7001/
WEB: https://localhost:7002/

MagicVilla_Web/appsettings.json
...
      },
      "AllowedHosts": "*",
      "ServiceUrls": {
        "VillaAPI": "https://localhost:7001"
      }
    }


62. Base Service for API






63. Adding Villa Service






64. Calling Villa API






65. Display all Villa List






66. Create Villa UI






67. Disable NULLABLE - IMPORTANT






68. Update Villa Action Methods






69. Update VIlla UI






70. Delete Villa






71. Add VillaNumberService






72. Getting Villa Numbers






73. Include Villa when retireving Villa Number






74. Bootswatch Theme






75. Villa Home Page






76. Move Images






77. Villa Number Assignment






78. Create Villa Number GET






79. Create Villa POST






80. Special Validation and Base Service Update






81. Display API Error Messages






82. Update and Delete Action Method for Villa Number






83. Update and Delete Villa Number






84. Sweet Alert





